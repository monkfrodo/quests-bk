<!doctype html>
<html lang="pt-br">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Diehard | Quest Teams</title>
<link rel="icon" href="https://www.tibiawiki.com.br/images/6/63/Icone7.png">
<style>
:root {
  --bordo:#832d35;
  --bordo-light:#9c3b43;
  --bg:#0b0a0a;
  --card:#151112e6;
  --stroke:#ffffff1a;
  --text:#f3f2f1;
  --muted:#a9a4a4;
  --green:#22c55e;
  --orange:#f59e0b;
  --red:#ef4444;
  --radius:14px;
}
*{box-sizing:border-box;margin:0;padding:0}
html,body{
  font-family:'Inter',system-ui,sans-serif;
  background:var(--bg);
  color:var(--text);
  height:100%;
  min-height:100%;
  overflow-x:hidden;
}
body::before {
  content:"";
  position:fixed;
  top:0;left:0;width:100%;height:100%;
  z-index:-2;
  background:url('https://preview.redd.it/i-tried-to-make-a-version-of-tibia-8-6-screen-with-more-v0-gcs5d4co5z891.png?width=1080&crop=smart&auto=webp&s=9858d97fff58d708fca33a391d49cd726347ee21')
  center center / cover no-repeat fixed;
  transform:translateZ(0);
}
body::after {
  content:"";
  position:fixed;
  top:0;left:0;width:100%;height:100%;
  z-index:-1;
  pointer-events:none;
  background:radial-gradient(ellipse at center, rgba(0,0,0,0.55) 0%, rgba(0,0,0,0.9) 60%, rgba(0,0,0,1) 100%);
  backdrop-filter:blur(2px);
}
@supports (-webkit-touch-callout: none) {
  html, body {height: -webkit-fill-available;}
}
.wrap{max-width:900px;margin:auto;padding:60px 16px;text-align:center;}
h1{display:flex;justify-content:center;align-items:center;gap:10px;font-size:30px;margin-bottom:20px;}
h1 img{width:34px;height:34px;}
.form-card{
  background:var(--card);
  border:1px solid var(--stroke);
  border-radius:var(--radius);
  padding:28px 20px;
  max-width:420px;
  margin:auto;
  text-align:left;
  box-shadow:0 0 40px rgba(0,0,0,0.4);
}
label{font-size:14px;color:var(--muted);display:block;margin-bottom:6px;}
input,select{
  width:100%;padding:10px 12px;border-radius:10px;
  border:1px solid var(--stroke);
  background:#0e0b0b;color:var(--text);font-size:15px;
}
button{
  background:var(--bordo-light);border:none;border-radius:10px;
  color:#fff;font-weight:600;font-size:15px;
  padding:10px 18px;cursor:pointer;transition:.2s;
}
button:hover{filter:brightness(1.15);}
.buttons{display:flex;justify-content:center;margin-top:14px;}
.voc-menu{display:grid;grid-template-columns:repeat(2,1fr);gap:8px;margin-top:6px;}
.voc-item{background:#1b1516;border:1px solid var(--stroke);border-radius:10px;padding:8px;text-align:center;cursor:pointer;}
.voc-item.active{outline:2px solid var(--bordo);}
.toast{position:fixed;top:15px;left:50%;transform:translateX(-50%);background:#1d1618;border:1px solid var(--stroke);padding:10px 16px;border-radius:10px;opacity:0;transition:.3s;z-index:99;}
.toast.show{opacity:1;}
.grid{margin-top:60px;display:grid;grid-template-columns:repeat(auto-fit,minmax(290px,1fr));gap:20px;justify-items:center;}
.card{
  background:var(--card);
  border:1px solid var(--stroke);
  border-radius:var(--radius);
  padding:18px 16px 20px;
  text-align:left;
  width:100%;max-width:320px;
  box-shadow:0 4px 25px rgba(0,0,0,.3);
}
.title{display:flex;align-items:center;gap:6px;font-weight:700;font-size:16px;}
.head{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;}
.bar{height:7px;border-radius:999px;overflow:hidden;margin-bottom:8px;border:1px solid var(--stroke);}
.fill{height:100%;}
.fill.red{background:var(--red);} .fill.orange{background:var(--orange);} .fill.green{background:var(--green);}
ul{padding-left:18px;margin:0;font-size:14px;}
.sched{display:flex;justify-content:space-between;align-items:center;margin-top:12px;gap:8px;}
.sched input[type="datetime-local"]{flex:1;min-width:0;padding:8px 10px;border-radius:8px;border:1px solid var(--stroke);background:#0f0b0b;color:#fff;font-size:14px;}
.sched button{flex-shrink:0;white-space:nowrap;padding:9px 14px;}
small{display:block;margin-top:6px;color:var(--muted);}
@media (max-width: 600px){
  .wrap{padding:30px 12px;}
  .form-card{padding:20px 14px;}
  .sched{flex-direction:column;align-items:stretch;}
  .sched button{width:100%;}
}
</style>
</head>
<body>
<div class="wrap">
  <h1><img src="https://www.tibiawiki.com.br/images/6/63/Icone7.png">Diehard | Quest Teams</h1>
  <div class="form-card" id="form">
    <div id="step1" class="step">
      <label>Seu nome</label>
      <input id="nome" placeholder="Ex: Monk Frodo">
      <div class="buttons"><button id="btnNext1" disabled>Continuar</button></div>
    </div>
    <div id="step2" class="step" style="display:none">
      <label>Vocação</label>
      <div class="voc-menu" id="vocs"></div>
      <label style="margin-top:10px;">Level</label>
      <input id="level" type="number" min="1" placeholder="Ex: 300">
      <div class="buttons">
        <button id="back2">Voltar</button>
        <button id="next2" disabled>Continuar</button>
      </div>
    </div>
    <div id="step3" class="step" style="display:none">
      <label>Quest</label>
      <input id="quest" placeholder="Ex: Warzone 4" list="qlist">
      <datalist id="qlist"></datalist>
      <div class="buttons">
        <button id="back3">Voltar</button>
        <button id="finish" disabled>Entrar no time</button>
      </div>
    </div>
  </div>
  <div id="grid" class="grid"></div>
</div>
<div class="toast" id="toast">OK</div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbziIHrXBpoNWvDiclUBfNu-YrxfGVJMZ70LOrxWzKlDHAOQxhbYsEtwpT-YoSEBRbss1w/exec";
const vocs=["RP","MS","ED","EK","EM"];
const icons=[
  "https://www.tibiawiki.com.br/images/9/96/Icone15.png",
  "https://www.tibiawiki.com.br/images/d/d7/Icone16.png",
  "https://www.tibiawiki.com.br/images/6/67/Icone10.png",
  "https://www.tibiawiki.com.br/images/9/9b/Snowbash.gif",
  "https://www.tibiawiki.com.br/images/a/a8/Icone2.png",
  "https://www.tibiawiki.com.br/images/3/37/Icone3.png",
  "https://www.tibiawiki.com.br/images/6/65/Icone14.png",
  "https://www.tibiawiki.com.br/images/3/36/Icone13.png"
];
let user={nome:"",voc:"",level:"",quest:""};
function $(s){return document.querySelector(s);}
function toast(msg){const t=$("#toast");t.textContent=msg;t.classList.add("show");setTimeout(()=>t.classList.remove("show"),1500);}
$("#nome").oninput=e=>$("#btnNext1").disabled=!e.target.value.trim();
$("#btnNext1").onclick=()=>{user.nome=$("#nome").value.trim();goto(2);}
$("#back2").onclick=()=>goto(1);
$("#back3").onclick=()=>goto(2);
$("#level").oninput=()=>$("#next2").disabled=!($("#level").value.trim()&&user.voc);
$("#next2").onclick=()=>{user.level=$("#level").value.trim();goto(3);}
$("#quest").oninput=e=>$("#finish").disabled=!e.target.value.trim();
$("#finish").onclick=async()=>{
  user.quest=$("#quest").value.trim();
  await fetch(API_URL,{method:"POST",body:new URLSearchParams(user)});
  toast("Time atualizado!");await load();goto(1);
};
function goto(n){[1,2,3].forEach(i=>$("#step"+i).style.display=i===n?"block":"none");}
const vmenu=$("#vocs");
vocs.forEach(v=>{
  const d=document.createElement("div");
  d.className="voc-item";d.textContent=v;
  d.onclick=()=>{user.voc=v;$("#next2").disabled=!$("#level").value.trim();[...vmenu.children].forEach(c=>c.classList.remove("active"));d.classList.add("active");};
  vmenu.appendChild(d);
});
async function load(){
  try{
    const r=await fetch(API_URL);const data=await r.json();
    render(data);
    const dl=$("#qlist");dl.innerHTML="";
    [...new Set(data.map(i=>i.quest))].forEach(q=>{
      const o=document.createElement("option");o.value=q;dl.appendChild(o);
    });
  }catch{render([]);}
}
function render(items){
  const g=$("#grid");g.innerHTML="";
  items.sort((a,b)=>b.count-a.count);
  items.forEach((it,i)=>{
    const bar=it.count>=5?"green":it.count>=3?"orange":"red";
    const icon=icons[i%icons.length];
    const c=document.createElement("div");
    c.className="card";
    c.innerHTML=`
      <div class="head"><div class="title"><img src="${icon}" width="18"> ${it.quest}</div><span>${it.count} ${it.count==1?"jogador":"jogadores"}</span></div>
      <div class="bar"><div class="fill ${bar}" style="width:${Math.min(100,(it.count/5)*100)}%"></div></div>
      <ul>${it.players.map(p=>`<li>${p.nome} (${p.vocacao}, lvl ${p.level})</li>`).join("")}</ul>
      <div class="sched"><input type="datetime-local" class="dt"><button class="btn">Agendar</button></div>
      ${it.scheduled_at?`<small>Agendado: ${it.scheduled_at}</small>`:""}
    `;
    c.querySelector(".btn").onclick=async()=>{
      const dt=c.querySelector(".dt").value;
      if(!dt)return toast("Escolha data/hora");
      await fetch(API_URL,{method:"POST",body:new URLSearchParams({action:"schedule",quest:it.quest,when:new Date(dt).toISOString(),nome:user.nome||"Anônimo"})});
      toast("Agendado!");load();
    };
    g.appendChild(c);
  });
}
load();
</script>
</body>
</html>
