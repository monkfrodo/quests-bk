<!doctype html>
<html lang="pt-br">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Times de Quest | Blackout Guild</title>
<style>
  body{background:#0b1220;color:#e5ecff;font-family:Inter,system-ui,sans-serif;margin:0;padding:30px}
  h1{text-align:center}
  form{max-width:500px;margin:0 auto;background:rgba(255,255,255,0.05);padding:20px;border-radius:12px}
  input,select{width:100%;padding:10px;margin:8px 0;border-radius:8px;border:1px solid rgba(255,255,255,0.1);background:#10182b;color:#fff;font-size:15px}
  button{width:100%;padding:12px;margin-top:10px;background:#3b82f6;color:#fff;border:none;border-radius:8px;font-weight:600;cursor:pointer}
  .quests{margin-top:40px;max-width:700px;margin-inline:auto}
  .quest{background:rgba(255,255,255,0.05);padding:16px;border-radius:12px;margin-bottom:10px}
  .bar{height:8px;background:#10182b;border-radius:999px;overflow:hidden;margin-top:8px}
  .fill{height:100%;background:#22c55e}
</style>
</head>
<body>
<h1>Formação de Times de Quest</h1>

<form id="questForm">
  <input type="text" id="nome" placeholder="Seu nome" required>
  <select id="vocacao" required>
    <option value="">Vocação</option>
    <option>EK</option><option>RP</option><option>MS</option><option>ED</option><option>EM</option>
  </select>
  <input type="number" id="level" placeholder="Level" required>
  <input type="text" id="quest" placeholder="Nome da Quest" list="listaQuests" required>
  <datalist id="listaQuests"></datalist>
  <button type="submit">Registrar interesse</button>
</form>

<div class="quests" id="quests"></div>

<script>
const API = "https://script.google.com/macros/s/AKfycbziIHrXBpoNWvDiclUBfNu-YrxfGVJMZ70LOrxWzKlDHAOQxhbYsEtwpT-YoSEBRbss1w/exec"; // <--- substitua

async function loadQuests(){
  const res = await fetch(API);
  const data = await res.json();
  const wrap = document.getElementById('quests');
  wrap.innerHTML = '';
  data.forEach(q=>{
    const div = document.createElement('div');
    div.className='quest';
    const pct = Math.min(q.count*25,100); // barra simbólica
    div.innerHTML = `
      <strong>${q.quest}</strong><br>
      ${q.count} jogador(es) interessado(s)
      <div class="bar"><div class="fill" style="width:${pct}%"></div></div>
    `;
    wrap.appendChild(div);
  });
  // Sugestões no datalist
  const dl = document.getElementById('listaQuests');
  dl.innerHTML = data.map(q=>`<option value="${q.quest}">`).join('');
}

document.getElementById('questForm').addEventListener('submit',async e=>{
  e.preventDefault();
  const fd = new FormData();
  fd.append('nome',nome.value);
  fd.append('vocacao',vocacao.value);
  fd.append('level',level.value);
  fd.append('quest',quest.value);
  await fetch(API,{method:'POST',body:fd});
  alert('Registrado!');
  e.target.reset();
  loadQuests();
});

loadQuests();
</script>
</body>
</html>
